<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta charset='UTF-8' />
    <meta http-equiv='X-UA-Compatible' content='IE=edge' />
    <meta
      name='viewport'
      content='width=device-width, initial-scale=1.0'
    />
    <title>{{site.title}}</title>
    <link rel='icon' href='/images/favicon.png' />
    <script type='module' src='/scripts/main.ts'></script>
  </head>
  <body style='opacity: 0' data-barba='wrapper'>
    <c-navbar>
      <a href='/'>
        <img src='{{site.logo_header}}' />
      </a>
    </c-navbar>

    <c-nav-menu navLinks='{{site.menu_items}}'>
    </c-nav-menu>

    <div asscroll-container>
      <main
        data-barba='container'
        data-barba-namespace='contact'
        asscroll
      >
        <c-bounce-title
          class='u-margin-navbar-top'
          text='get in touch'
        >
        </c-bounce-title>

        <form
          class='c-form js-contact-form'
          name='contact'
          method='POST'
          data-netlify='true'
        >
          <input
            type='text'
            name='name'
            placeholder='your name'
          />
          <input
            type='email'
            name='email'
            placeholder='your email'
          />
          <div class='c-form__grow-wrap'>
            <textarea
              onInput='this.parentNode.dataset.replicatedValue = this.value'
              name='message'
              placeholder='your message'
              rows='1'
            ></textarea>
          </div>
          <c-button
            text='send'
            type='submit'
            large
          >
          </c-button>
        </form>
      </main>

      <svg
        class='c-cursor'
        width='25' height='25'
        viewBox='0 0 25 25'
      >
        <circle
          class='c-cursor__inner'
          cx='12.5'
          cy='12.5'
          r='6.25'
        />
      </svg>

      <c-footer
        socialLinks='{{site.social_links}}'
        navLinks='{{site.menu_items}}'
        logo='{{site.logo_footer}}'
        asscroll
      >
        <div slot='heading' class='u-heading-huge-fluid'>
          {{{site.footer_heading}}}
        </div>
      </c-footer>
    </div>

    <script>
      const contactForm = document.querySelector(
        '.js-contact-form'
      )

      if (contactForm) {

        const serialize = function (form) {

          let field
          let l
          let s = []

          if (
            typeof form == 'object' &&
            form.nodeName == 'FORM'
          ) {
            const len = form.elements.length

            for (let i = 0; i < len; i++) {
              field = form.elements[i]
              if (
                field.name &&
                !field.disabled &&
                field.type != 'button' &&
                field.type != 'file' &&
                field.type != 'hidden' &&
                field.type != 'reset' &&
                field.type != 'submit'
              ) {
                if (field.type == 'select-multiple') {
                  l = form.elements[i].options.length

                  for (let j = 0; j < l; j++) {
                    if (field.options[j].selected) {
                      s[s.length] =
                        encodeURIComponent(field.name) +
                        '=' +
                        encodeURIComponent(
                          field.options[j].value
                        )
                    }
                  }
                } else if (
                  (field.type != 'checkbox' &&
                    field.type != 'radio') ||
                  field.checked
                ) {
                  s[s.length] =
                    encodeURIComponent(field.name) +
                    '=' +
                    encodeURIComponent(field.value)
                }
              }
            }
          }
          return s.join('&').replace(/%20/g, '+')

        }
        contactForm.addEventListener('submit', e => {

          e.preventDefault()

          const theForm = e.currentTarget

          const formData =
            'form-name=' +
            theForm.name +
            '&' +
            serialize(theForm)

          const options = {
            method: 'POST',
            headers: {
              'Content-Type':
                'application/x-www-form-urlencoded'
            },
            body: formData
          }

          fetch('/', options)
            .then(function (response) {

              window.location.assign(theForm.action)

            })
            .catch(function (error) {

              console.log(error)

            })
        })

      }
    </script>

    <script
      src='https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.1.3/p5.min.js'
      integrity='sha512-xrAcaPlDVY5TDNAKKsVPf040TnCatM3YFUi/AChhyBLJ1IVn+lbAKTiVDjhicrUFPqz/IvC0S2uVlbi7iF6I7w=='
      crossorigin='anonymous'
      referrerpolicy='no-referrer'
    ></script>
  </body>
</html>
